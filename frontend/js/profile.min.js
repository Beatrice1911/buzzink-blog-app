const API_URI="/api",urlParams=new URLSearchParams(window.location.search),username=urlParams.get("user");async function fetchUserProfile(t){try{const t=new URLSearchParams(window.location.search).get("id"),e=await fetch(`/api/users/id/${t}`);if(!e.ok)throw new Error("User not found");const n=await e.json();document.getElementById("profile-name").textContent=n.name,document.getElementById("profile-bio").textContent=n.bio||"This user has no bio.",document.getElementById("profile-date").textContent=`Joined: ${new Date(n.createdAt).toDateString()}`;const o="https://i.postimg.cc/KvF0rh0Q/custom-default-avatar.png",s=n.profilePhoto?.trim()||o;document.getElementById("profile-photo").src=s,document.getElementById("user-name-label").textContent=n.name;const a=await fetch(`/api/posts?authorId=${n._id}&limit=1000`);if(!a.ok)throw new Error("Failed to fetch user's posts");const{posts:r}=await a.json();document.getElementById("posts-list").innerHTML=r.length?r.map(t=>`\n            <div class="post-card" data-slug="${t.slug}">\n                <h3>${t.title}</h3>\n                <p>${t.content.substring(0,120)+"..."}</p>\n            </div>\n            `).join(""):"<p class='no-posts'>No posts available.</p>";document.querySelectorAll(".post-card").forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.slug;window.location.href=`post.html?slug=${e}`})})}catch(t){document.body.innerHTML=`<p>${t.message}</p>`}}username?fetchUserProfile(username):document.body.innerHTML="<h2>User not specified</h2>";